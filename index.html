<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>修辭手法互動溫習站 - 專業擴充版</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .flashcard-inner {
            transition: transform 0.6s;
            transform-style: preserve-3d;
            cursor: pointer;
        }
        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }
        .flashcard-front, .flashcard-back {
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
        }
        .flashcard-back {
            transform: rotateY(180deg);
        }
        .checkbox-custom:checked + label {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        .perspective-1000 {
            perspective: 1000px;
        }
    </style>
</head>
<body class="bg-slate-50 min-h-screen font-sans">

    <div class="max-w-4xl mx-auto py-8 px-4">
        <header class="text-center mb-8">
            <h1 class="text-3xl font-bold text-slate-800 mb-2">修辭手法互動溫習站</h1>
            <p class="text-slate-500">附件完整數據載入：24 類修辭真實題庫</p>
        </header>

        <!-- 設定區域 -->
        <div id="setupArea" class="bg-white rounded-2xl shadow-sm p-6 mb-8 border border-slate-200">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-lg font-semibold text-slate-700">選擇練習範圍</h2>
                <div class="space-x-1">
                    <button id="selectAll" class="text-xs bg-slate-100 text-slate-600 px-3 py-1.5 rounded-md hover:bg-blue-100 hover:text-blue-700 transition">全選</button>
                    <button id="deselectAll" class="text-xs bg-slate-100 text-slate-600 px-3 py-1.5 rounded-md hover:bg-red-50 hover:text-red-700 transition">清空</button>
                </div>
            </div>
            
            <div id="filterOptions" class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-2">
                <!-- JS 動態生成 -->
            </div>
            
            <button id="startBtn" class="w-full mt-6 bg-blue-600 text-white py-3.5 rounded-xl font-bold hover:bg-blue-700 transition-all shadow-lg shadow-blue-200 active:scale-[0.98]">
                開始練習 (隨機抽題)
            </button>
        </div>

        <!-- 練習區域 -->
        <div id="studyArea" class="hidden">
            <div class="flex justify-between items-center mb-4">
                <button id="backToSetup" class="text-sm text-slate-400 hover:text-blue-600 transition flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
                    返回設定
                </button>
                <div class="text-sm font-medium text-slate-500">
                    進度：<span id="currentIndex">1</span> / <span id="totalCount">0</span>
                </div>
            </div>

            <div class="w-full bg-slate-200 h-1.5 rounded-full mb-8 overflow-hidden">
                <div id="progressBar" class="bg-blue-500 h-full transition-all duration-300" style="width: 0%"></div>
            </div>

            <div id="cardWrapper" class="flashcard h-96 w-full perspective-1000 mb-8">
                <div class="flashcard-inner relative w-full h-full text-center shadow-xl rounded-2xl transform-gpu transition-all duration-500 bg-white">
                    <div class="flashcard-front absolute w-full h-full p-8 flex flex-col justify-center items-center bg-white rounded-2xl border border-slate-100">
                        <span class="px-3 py-1 bg-blue-50 text-blue-500 text-xs font-bold rounded-full mb-4 tracking-widest uppercase">例句範例</span>
                        <p id="frontSentence" class="text-xl md:text-2xl font-medium text-slate-800 leading-relaxed px-4 text-center"></p>
                        <div class="mt-8 flex items-center text-slate-300 text-xs">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4" /></svg>
                            點擊卡片翻轉查看解析
                        </div>
                    </div>
                    <div class="flashcard-back absolute w-full h-full p-8 flex flex-col justify-center items-center bg-blue-600 rounded-2xl text-white">
                        <span class="text-blue-200 text-xs font-bold mb-2 tracking-widest uppercase">修辭手法</span>
                        <h3 id="backType" class="text-3xl font-bold mb-4"></h3>
                        <div class="h-px w-16 bg-blue-400 opacity-50 mb-4"></div>
                        <p id="backReason" class="text-base text-blue-50 leading-relaxed max-w-md text-left"></p>
                    </div>
                </div>
            </div>

            <div class="flex gap-4">
                <button id="prevBtn" class="flex-1 py-4 bg-white border border-slate-200 text-slate-600 rounded-xl font-semibold hover:bg-slate-50 disabled:opacity-30 disabled:cursor-not-allowed transition">上一張</button>
                <button id="nextBtn" class="flex-1 py-4 bg-slate-800 text-white rounded-xl font-semibold hover:bg-slate-900 transition shadow-lg">下一張</button>
            </div>
        </div>
    </div>

    <script>
        const rhetoricTypes = [
            "明喻", "暗喻", "借喻", "借代", "反語", "反問", "設問", "排比", 
            "對偶", "對比", "頂真", "互文", "擬人", "擬物", "層遞", "反復", 
            "誇飾", "正襯", "反襯", "引用", "通感", "呼告", "疊字"
        ];

        // 完整數據載入 (來自附件內容)
        const data = [
            { type: "明喻", sentence: "運動員在賽場上像離弦的箭一般衝向終點。", reason: "本體（運動員）、喻詞（像）、喻體（箭）。" },
            { type: "明喻", sentence: "那片楓林火紅火紅的，像一團燃燒的火焰。", reason: "將楓林比作火焰，使用了喻詞「像」。" },
            { type: "明喻", sentence: "小弟弟的臉蛋紅通通的，像一個大蘋果。", reason: "將臉蛋比作蘋果，喻詞為「像」。" },
            { type: "暗喻", sentence: "老師是辛勤的園丁，細心呵護著祖國的花朵。", reason: "使用聯繫詞「是」將老師比作園丁。" },
            { type: "暗喻", sentence: "書籍是心靈的良藥。", reason: "本體「書籍」直接等同於喻體「良藥」。" },
            { type: "暗喻", sentence: "父愛是一座大山，讓我們感到安全。", reason: "將父愛比作大山，聯繫詞為「是」。" },
            { type: "借喻", sentence: "只有挺拔的松柏，才能經受住嚴冬的考驗。", reason: "直接以喻體「松柏」代表意志堅強的人，本體不出現。" },
            { type: "借喻", sentence: "在無邊的黑暗中，他終於盼到了遠方的歸帆。", reason: "以「歸帆」喻指回家的希望，不見本體（船/家人）。" },
            { type: "借喻", sentence: "這場晚年的風雪，他們要攜手熬過去。", reason: "以「風雪」喻指人生艱辛，本體（苦難）未出現。" },
            { type: "借喻", sentence: "別讓世俗的枷鎖鎖住了你的靈魂。", reason: "以「枷鎖」喻指束縛，本體（限制/規則）不出現。" },
            { type: "借喻", sentence: "歲月的刻刀在他的臉上留下了深深的印記。", reason: "以「刻刀」喻指流逝的時間，本體未出現。" },
            { type: "借代", sentence: "遠處傳來陣陣銀鈴般的笑聲。", reason: "以聲音特徵「銀鈴」代指清脆的笑聲。" },
            { type: "借代", sentence: "那群紅領巾在街上幫老人過馬路。", reason: "以特徵「紅領巾」代指少先隊員。" },
            { type: "借代", sentence: "巾幗不讓鬚眉。", reason: "「巾幗」代指女性，「鬚眉」代指男性。" },
            { type: "反語", sentence: "你這人可真大方，連一塊錢也要跟同學計較半年。", reason: "名為讚美「大方」，實則諷刺「吝嗇」。" },
            { type: "反語", sentence: "這音樂可真動聽，聽得鄰居都報警了。", reason: "名為讚美「動聽」，實則諷刺「難聽噪音」。" },
            { type: "反語", sentence: "他真是個天才，連這麼簡單的題目都能答錯。", reason: "名為讚美「天才」，實則諷刺「笨拙」。" },
            { type: "反問", sentence: "難道我們不應該為保護環境貢獻一份力量嗎？", reason: "答案就在問句中（應該），加強肯定語氣。" },
            { type: "反問", sentence: "難道這不是我們大家共同的責任嗎？", reason: "強調「這是大家的責任」。" },
            { type: "設問", sentence: "幸福是什麼？幸福就是與家人團聚的時刻。", reason: "自問自答，引發閱讀興趣。" },
            { type: "設問", sentence: "誰是最可愛的人？我們的戰士是最可愛的人。", reason: "自問自答，強調情感。" },
            { type: "排比", sentence: "這裡的楓葉紅得像火，紅得像霞，紅得像血。", reason: "三個結構相似、語氣一致的短語並列。" },
            { type: "排比", sentence: "愛心是一片照射在冬日的陽光，愛心是一泓出現在沙漠裡的泉水。", reason: "結構對稱，增強氣勢。" },
            { type: "對偶", sentence: "綠窗明月在，青史古人空。", reason: "字數相等，詞性相對。" },
            { type: "對偶", sentence: "橫眉冷對千夫指，俯首甘為孺子牛。", reason: "結構工整，意義對稱。" },
            { type: "對比", sentence: "有的人活著，他已經死了；有的人死了，他還活著。", reason: "將「生」與「死」的對立價值進行比較。" },
            { type: "頂真", sentence: "歸來見天子，天子坐明堂。", reason: "前句結尾「天子」作為後句開頭。" },
            { type: "頂真", sentence: "出門看夥伴，夥伴皆驚忙。", reason: "首尾相接，連環遞進。" },
            { type: "誇飾", sentence: "這間屋子太小了，連站的地方都沒有。", reason: "誇大「小」的程度，強調空間侷促。" },
            { type: "誇飾", sentence: "白髮三千丈，離愁似個長。", reason: "極度誇張白髮長度來表達深重的離愁。" },
            { type: "通感", sentence: "微風過處，送來縷縷清香，彷彿高樓上渺茫的歌聲似的。", reason: "嗅覺（清香）轉化為聽覺（歌聲）。" },
            { type: "通感", sentence: "他的聲音是甜潤的。", reason: "聽覺（聲音）轉化為味覺（甜）。" },
            { type: "通感", sentence: "寂靜在空氣中發酵。", reason: "聽覺（寂靜）轉化為嗅覺或動態感。" },
            { type: "通感", sentence: "這顏色亮得耀眼，甚至有些燙人。", reason: "視覺（亮）轉化為觸覺（燙）。" },
            { type: "呼告", sentence: "祖國啊，我親愛的母親！", reason: "直接對「祖國」進行呼喚。" },
            { type: "呼告", sentence: "大地啊，請賜予我們力量吧！", reason: "直接對著大地傾訴與請求。" },
            { type: "呼告", sentence: "朋友們，讓我們攜手並進！", reason: "直接呼喚在場的受眾。" },
            { type: "引用", sentence: "常言道：「失敗乃成功之母」，我們不應氣餒。", reason: "直接引用社會公認的格言。" },
            { type: "正襯", sentence: "桃花潭水深千尺，不及汪倫送我情。", reason: "用潭水的深來襯托友誼更深，方向一致。" },
            { type: "反襯", sentence: "蟬噪林逾靜，鳥鳴山更幽。", reason: "用喧鬧（蟬噪鳥鳴）襯托出極度的幽靜。" },
            { type: "擬人", sentence: "小雨點在屋頂上跳起了輕快的舞。", reason: "賦予雨點跳舞的人類行為。" },
            { type: "擬物", sentence: "他在人群中東奔西跑，像是一隻沒頭蒼蠅。", reason: "將人比作動物來描寫（擬動物）。" },
            { type: "層遞", sentence: "古之欲明明德於天下者，先治其國；欲治其國者，先齊其家；欲齊其家者，先修其身。", reason: "由大到小、由遠及近層層推進。" },
            { type: "反復", sentence: "盼望著，盼望著，東風來了，春天的腳步近了。", reason: "重複使用「盼望著」強調心情急切。" },
            { type: "疊字", sentence: "尋尋覓覓，冷冷清清，淒淒慘慘戚戚。", reason: "使用多組疊字增強節奏感與憂鬱氣氛。" },
            { type: "互文", sentence: "秦時明月漢時關。", reason: "秦、漢與明月、關隘互相補充（秦漢時的明月與關隘）。" },
            { type: "互文", sentence: "主人下馬客在船。", reason: "指主人與客人一起下馬並上船。" }
        ];

        let currentQuestions = [];
        let currentPointer = 0;

        // 初始化 UI
        const filterContainer = document.getElementById('filterOptions');
        rhetoricTypes.forEach(type => {
            const div = document.createElement('div');
            div.innerHTML = `
                <input type="checkbox" id="check-${type}" value="${type}" class="checkbox-custom hidden" checked>
                <label for="check-${type}" class="px-2 py-1.5 border border-slate-200 rounded-lg cursor-pointer hover:border-blue-300 hover:bg-blue-50 transition block text-xs font-medium text-slate-600 text-center">
                    ${type}
                </label>
            `;
            filterContainer.appendChild(div);
        });

        function shuffle(array) {
            return [...array].sort(() => Math.random() - 0.5);
        }

        function updateCardDisplay() {
            const cardWrapper = document.getElementById('cardWrapper');
            cardWrapper.classList.remove('flipped'); 
            const current = currentQuestions[currentPointer];
            
            setTimeout(() => {
                document.getElementById('frontSentence').innerText = current.sentence;
                document.getElementById('backType').innerText = current.type;
                document.getElementById('backReason').innerHTML = `<span class="font-bold text-white/60">解析：</span><br/>${current.reason}`;
                document.getElementById('currentIndex').innerText = currentPointer + 1;
                document.getElementById('totalCount').innerText = currentQuestions.length;
                const progress = ((currentPointer + 1) / currentQuestions.length) * 100;
                document.getElementById('progressBar').style.width = `${progress}%`;
                document.getElementById('prevBtn').disabled = currentPointer === 0;
                document.getElementById('nextBtn').innerText = currentPointer === currentQuestions.length - 1 ? '完成溫習' : '下一張';
            }, 100);
        }

        document.getElementById('startBtn').addEventListener('click', () => {
            const selectedTypes = Array.from(document.querySelectorAll('.checkbox-custom:checked')).map(cb => cb.value);
            if (selectedTypes.length === 0) {
                alert("請至少選擇一個修辭手法！");
                return;
            }
            // 只篩選選定的真實數據，不再自動補位
            currentQuestions = shuffle(data.filter(item => selectedTypes.includes(item.type)));
            
            if (currentQuestions.length === 0) {
                alert("所選類型目前題庫中暫無題目。");
                return;
            }

            currentPointer = 0;
            document.getElementById('setupArea').classList.add('hidden');
            document.getElementById('studyArea').classList.remove('hidden');
            updateCardDisplay();
        });

        document.getElementById('nextBtn').addEventListener('click', () => {
            if (currentPointer < currentQuestions.length - 1) {
                currentPointer++;
                updateCardDisplay();
            } else {
                alert("太棒了！溫習完畢。");
                document.getElementById('backToSetup').click();
            }
        });

        document.getElementById('prevBtn').addEventListener('click', () => {
            if (currentPointer > 0) {
                currentPointer--;
                updateCardDisplay();
            }
        });

        document.getElementById('cardWrapper').addEventListener('click', function() {
            this.classList.toggle('flipped');
        });

        document.getElementById('backToSetup').addEventListener('click', () => {
            document.getElementById('studyArea').classList.add('hidden');
            document.getElementById('setupArea').classList.remove('hidden');
        });

        document.getElementById('selectAll').addEventListener('click', () => {
            document.querySelectorAll('.checkbox-custom').forEach(cb => cb.checked = true);
        });
        
        document.getElementById('deselectAll').addEventListener('click', () => {
            document.querySelectorAll('.checkbox-custom').forEach(cb => cb.checked = false);
        });
    </script>
</body>
</html>